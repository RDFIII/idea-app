<%= @idea.title %><br>
<%= @idea.body %>


<% def display_comments(commentable) %>
    <% if commentable.comments.length == 0 then return end %>
    <% commentable.comments.order(:created_at).each do |c| %>
      <p><%= c.user.username %> </p>
      <p><%= c.text %> </p>
      <p> Submitted <%= time_ago_in_words(c.created_at) %> ago </p>
      <p><% p c.commentable_id %></p>

      <%= form_for Comment.new do |f| %>
        <%= f.hidden_field(:commentable_id, value: c.id) %>
        <%= f.hidden_field(:commentable_type, value: c.class.name) %>
        <%= f.label :comment %>
        <%= f.text_field :text %>
        <%= f.submit "Submit", class: "btn btn-primary" %>
     <% end %>

      <p> --------------------------------- </p>

      <div class="nested">
        <p><% display_comments(c) %> </p>
      </div>
      <% end %>
      
<% end %>


<% display_comments(@idea) %>
